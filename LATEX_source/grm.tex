\documentclass{beamer}
%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{default} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
  \setbeamertemplate{footline}[frame number]
} 

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric,arrows}
\usepackage{pgfplots} % For Tikz
% Package for adding comments add disable in [] to remove all comments
%\usepackage[]{todonotes}
\usepackage{amssymb,amsmath}
\usefonttheme{professionalfonts}

\title[Gradient-based Cooperative Control of quasi-Linear Parameter Varying Vehicles with Noisy Gradients]{Gradient-based Cooperative Control of quasi-Linear Parameter Varying Vehicles with Noisy Gradients}
\author{Adwait Datar}
\institute{PhD Workshop, 2023\\Technical University of Hamburg}
\date{$17^{th}$ Feb, 2023}

\begin{document}

\begin{frame}	
  \titlepage
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Source-seeking Problem}
	\begin{figure}[!htb]
		\centering
		\begin{minipage}{.5\textwidth}
			\centering
			\includegraphics[width=0.9\linewidth,height=0.45\textheight]{figures/single_quad_field.jpg}
			%\caption{Single quadrotor}
			\label{fig:single_quad}
			Single agent
		\end{minipage}%
		\begin{minipage}{0.5\textwidth}
			\centering
			\includegraphics[width=0.9\linewidth,height=0.45\textheight]{figures/multiple_quad_field.jpg}
			%\caption{Multiple quadrotors}
			\label{fig:multiple_quads}
			Multiple agents
		\end{minipage}
	\end{figure}
	\begin{block}{Problem Setting}
		\begin{itemize}		
			\item Field is differentiable and convex
			\item \textit{Noisy} gradients available at some leader agents 
			\item Agent dynamics governed by a quasi-LPV model
		\end{itemize}		
	\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Control Architecture}
%	\begin{figure}[ht]
%		\input{figures/formation_control_arch_ss}
%%		\caption{Control architecture}
%		%\label{fig:control_architecture}	
%	\end{figure}
%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Robust Analysis Problem with Formation Control}
	\begin{overprint}
		\onslide<1>		
		\begin{figure}[!htb]
			\centering
			%		\input{figures/control_arch_rob_control_prob}
			\input{figures/control_arch_rob_control_prob_convex1}
		\end{figure}
		%	\onslide<2>
		%	\begin{figure}[!htb]
		%	\centering
		%	%		\input{figures/control_arch_rob_control_prob}
		%	\input{figures/control_arch_rob_control_prob_convex}
		%	\end{figure}
		%	\begin{assumption}
		%		\begin{itemize}
		%			\item $m_{\psi}I\preceq \nabla^2 \psi(y_i) \preceq L_{\psi}I$ (Notation: $\psi \in \mathcal{S}(m_{\psi},L_{\psi})$)
		%			\item Every agent has path to at least 1 informed agent
		%		\end{itemize}
		%	\end{assumption}
		%	$\implies mI\preceq \nabla^2 f(y) \preceq LI$ for suitable $m,L$ (i.e., $f \in \mathcal{S}(m,L)$)
		\onslide<2>
		\begin{figure}[!htb]
			\centering
			%		\input{figures/control_arch_rob_control_prob}
			\input{figures/control_arch_rob_control_prob_convex2}
		\end{figure}
%		\begin{block}{Problem 2}
%			%	\begin{Problem} \label{prob:formation_control}
%			Let $0 \prec m \cdot I\preceq \nabla^2 f(y) \preceq L\cdot I$ (\textcolor{red}{Notation: $f\in \mathcal{S}(m,L)$}), derive sufficient conditions (LMIs) independent of network size under which the state trajectories 
%			\begin{itemize}
%				\item[1)] remain bounded for all $t\geq 0$
%				\item[2)] $\exists \kappa \geq 0$ such that $||y(t)-y_*(t)||\leq \kappa e^{-\alpha t}$ holds for all $t\geq 0$
%			\end{itemize}
%			%	\end{Problem}
%		\end{block}	
		\onslide<3>	\begin{figure}[!htb]
			\centering
			%		\input{figures/control_arch_rob_control_prob}
			\input{figures/control_arch_rob_control_prob_convex3}
		\end{figure}
	\begin{block}{Assume}
		\begin{itemize}
			\item[1] $||\Delta||\leq \delta$
			\item[2] $0 \prec m \cdot I\preceq \nabla^2 f(y) \preceq L\cdot I$ (\textcolor{red}{Notation: $f\in \mathcal{S}(m,L)$}) 
		\end{itemize}
	\end{block}	
%		\begin{block}{Multiplicative Noise}
%			%	\begin{Problem} \label{prob:formation_control}
%			Let $0 \prec m \cdot I\preceq \nabla^2 f(y) \preceq L\cdot I$ (\textcolor{red}{Notation: $f\in \mathcal{S}(m,L)$}), derive sufficient conditions (LMIs) independent of network size under which the state trajectories 
%			\begin{itemize}
%				\item[1)] remain bounded for all $t\geq 0$
%				\item[2)] $\exists \kappa$ such that $||y(t)-y_*(t)||\leq \kappa e^{-\alpha t}$ holds for all $t\geq 0$
%			\end{itemize}
%			%	remain bounded for all $t\geq 0$ and $\exists \kappa \geq 0$ such that $||y(t)-y_*(t)||\leq \kappa e^{-\alpha t}$ holds for all $t\geq 0$.
%			%	\end{Problem}
%		\end{block}
	\end{overprint}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Control Architecture: Multiple agents}
	\begin{equation*} %\label{eq:sys_dyn_G}
		\begin{split}
			\Dot{{\eta}}(t)&=\hat{A}_G(\rho(t)){\eta}(t) + \hat{B}_G(\rho(t)) {u}(t), \quad \quad {\eta}(0)={\eta}_{0},\\
			{y}(t)&=\hat{C}_G(\rho(t)) {\eta}(t). \\
		\end{split}
	\end{equation*}
	where, notation $\hat{X}=I_N \otimes X$ and ${x}=[x_1^T,\hdots,x_N^T]^T$ is used.
	%	\pause
	\begin{block}{Formation control law with gradient-based forcing term}
		\begin{equation}\label{eq:control_law}
			{u}=\mathcal{L}_{(d)}({y}-{r})+\begin{bmatrix}u_{\psi_1}\\ \vdots \\u_{\psi_N}\end{bmatrix}.
		\end{equation}
		
		\begin{equation}\label{eq:forcing_term}
			\begin{split}
				u_{\psi_i}(t)&=
				\begin{cases}
					\nabla \psi(y_i), & \text{if}\ i\in \mathcal{V}_l, \\
					0, & \text{otherwise}.
				\end{cases}
			\end{split}
		\end{equation}
	\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{qLPV modeling}
\begin{block}{Assume}
There exists a function $g:\mathbb{R}^{n_{\eta}}\rightarrow\mathbb{R}^{n_{\rho}}$ such that $\rho(t)=g(\eta(t))\quad t\in[0,\infty)$ and there exists $c\geq 0$ such that 
\begin{equation*}
	\mathcal{B}(\eta_*,c)=\left\{ \eta:||\eta-\eta_*|| \leq c \right\} \subset \{\eta\in \mathbb{R}^{n_{\eta}}:g(\eta)\in \mathcal{P}\}=:\mathcal{P}^{-1}_g
\end{equation*}
\end{block}
\pause 
\begin{block}{Examples with $\eta=[x_1\quad x_2]^T$, $g:\mathbb{R}^2\rightarrow \mathbb{R}$, $\mathcal{P}=[-0.5,0.5]$}
\end{block}
%\begin{overprint}
%\onslide<+>
%1: $\rho=x_1$
%\onslide<+>
%2: $\rho=x_1+\textnormal{sign}(x_2)$
%\end{overprint}
%\vspace{2cm}
\begin{figure}
	
\begin{minipage}{.5\textwidth}
	\centering
	$\rho=x_1$
	\includegraphics[width=0.9\linewidth,height=0.43\textheight]{figures/sched_para_map_valid.jpg}
	%\caption{Single quadrotor}
\end{minipage}%
\begin{minipage}{0.5\textwidth}
	\centering
	$\rho=x_1+\textnormal{sign}(x_2)$
	\includegraphics[width=0.9\linewidth,height=0.43\textheight]{figures/sched_para_map_invalid.jpg}
	%\caption{Multiple quadrotors}
\end{minipage}
\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Main Result}
	\begin{block}{Theorem}	
			If there exist $\mathcal{X}_0\succ 0,P \in \mathbb{P}$, $\lambda \geq 0$ such that 
			\begin{align}\label{eq:perf_LMI_noise_single}
				%		\begin{split}
				&\begin{bmatrix}
					\mathcal{A}_0(\tilde{\rho})^T\mathcal{X}_0+\mathcal{X}\mathcal{A}_0(\tilde{\rho})+2\alpha \mathcal{X}_0  & (*) \\
					\mathcal{B}_0(\tilde{\rho})^T\mathcal{X}_0    & \mathbf{0}
				\end{bmatrix} \nonumber \\
				&\hspace{0.1cm}+			
				(*)
				\begin{bmatrix}
					P \otimes I_d &\\&\lambda (M \otimes I_d)
				\end{bmatrix}
				\begin{bmatrix}
					\mathcal{C}_{10}(\tilde{\rho}) & \mathcal{D}_{10}\\
					\mathcal{C}_{20} &\mathcal{D}_{20}\\
				\end{bmatrix}
				\preceq 
				0,
				%		\end{split}
			\end{align}
		holds for all $\tilde{\rho} \in \mathcal{P}$,
			then for all initial conditions $\eta_0$ such that $||\eta_0-\eta_*||< \frac{c}{\sqrt{\textnormal{cond}(\mathcal{X})}}$, the trajectories converge to the equilibrium exponentially at rate $\alpha$.
	\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Numerical results for a single LTI quadrotor}
	\begin{figure}[ht]
		\input{figures/control_arch}
		%\caption{Control architecture}	
	\end{figure}
	\begin{block}{Setup}
		\begin{itemize}
			\item Linearized quadrotor model + LQR local controller
			\item $||\Delta||\leq \delta$
		\end{itemize}
	\end{block}	
\end{frame}
\begin{frame}{Designing $k_d$ for largest convergence rate estimate $\alpha$}
	\begin{figure}[h!]
		%\includegraphics[width=8cm]{figures/Figure_IQC_paper.PNG}
		\centering
		\input{figures/optimal_kd_kp_ratio_ZF_noisy}
%		\caption{Performance estimates for quadrotor dynamics provided by first order ZF multipliers for $\psi \in \mathcal{S}(1,10)$ and varying $k_d$ with different bound $\delta \in \{0.1,0.2\cdots,0.9\}$ on the multiplicative noise (see Assumption \ref{assum:noise}).}
		\label{fig:quadrotor_optimal_kd_ZF_noisy}
	\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Conservatism estimation by searching for examples}
	\begin{figure}[h!]
		%\includegraphics[width=8cm]{figures/Figure_IQC_paper.PNG}
		\centering
		\input{figures/optimal_kd_kp_ratio_ZF_noisy_conservatism_2}
%		\caption{Conservatism analysis for quadrotor dynamics provided by first order ZF multipliers for $\psi \in \mathcal{S}(1,10)$ and varying $k_d$ with different bound $\delta \in \{0.1,0.2\cdots,0.9\}$ on the multiplicative noise (see Assumption \ref{assum:noise}).}
		\label{fig:quadrotor_optimal_kd_ZF_noisy_conservatism}
	\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Non-linear Friction Model}
	\begin{block}{Dynamics}
	\begin{equation}\label{eq:NLFsat}
		m\ddot{x}+b\vert\dot{x}\vert\dot{x} = u_F, 
	\end{equation}
	\end{block}
\begin{block}{qLPV representation}
\begin{equation}\label{eq:NLFssLPV}
	\begin{split}
		\begin{bmatrix} \dot{x}_{\textnormal{pos}}\\ \dot{x}_{\textnormal{vel}} \end{bmatrix} 
		&= 
		\begin{bmatrix} 0 & 1 \\ 0 & -\tfrac{b}{m}\rho \end{bmatrix} 
		\begin{bmatrix} x_{\textnormal{pos}}\\ x_{\textnormal{vel}} \end{bmatrix} 
		+
		\begin{bmatrix} 0 \\ \tfrac{1}{m} \end{bmatrix} 
		u_F
		\\[1mm]
		y
		&=
		\begin{bmatrix} 1 & 0 \end{bmatrix}
		\begin{bmatrix} x_{\textnormal{pos}}\\ x_{\textnormal{vel}} \end{bmatrix}
		\\[3mm]
		\rho(t) 
		&=
		\vert x_{\textnormal{vel}}(t)\vert,
		% \quad\rho :t \rightarrow \left[0,\,v_{\scaleto{\text{MAX}}{2.5pt}}\right]
	\end{split}
\end{equation}
\begin{block}{Synthesize an LPV controller on $\mathcal{P}=[0,5]$}
\end{block}
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Designing $k_d$ for largest convergence rate estimate $\alpha$}
	\begin{figure}[h!]
		\centering
		\input{figures/KdvsAlpha_Delta_L70_v3}
%		\caption{Variation of $k_d$ and $\delta$: convergence rates for different $k_d$ values and fixed $f \in \mathcal{S}(1,70)$ guaranteed by first order ZF multipliers.}
		\label{fig:KdvsAlpha_Delta_L70}
	\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Noise can destabilize the dynamics}
	\begin{figure}[h!]
		\centering
		\input{figures/1AgentNoise_v2}\\
		\caption{Single agent with noisy gradient and different values of $k_d$ optimized for $\delta=0$ and $\delta=0.5$ respectively.}
		\label{fig:1AgentNoise}
	\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Consensus at Source With $\delta=0.5$}
\begin{figure}[h!]
	\centering
	\input{figures/10agents_v2}\\
%	\caption{MAS scenario where 10 agents start at random initial conditions and reach the source of the field $\psi\in\mathcal{S}(1,66)$ with gradient noise $\delta= 0.5$ and $k_d=100$.}
	\label{fig:MAS}
\end{figure}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
\begin{center}
    \huge{Thank you}
\end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Main idea Behind Proof}
%	\begin{align*}
%		&\left[\begin{array}{c|c}
%			\mathcal{A}_0(\tilde{\rho})    &  \mathcal{B}_0(\tilde{\rho})\\
%			\hline
%			\mathcal{C}_{10}(\tilde{\rho})    &  \mathcal{D}_{10}\\
%			\mathcal{C}_{20}    &  \mathcal{D}_{20}\\
%		\end{array}\right]= 
%		\left[ 
%		\begin{array}{cc}
%			\Pi_0 & \\
%			&I_{2d}\\
%		\end{array}\right]
%		\left[\begin{array}{c|ccc}
%			A_G(\tilde{\rho}) & B_G(\tilde{\rho}) & B_G(\tilde{\rho})\\	
%			\hline
%			C_G(\tilde{\rho})  & \mathbf{0}& \mathbf{0}\\
%			\mathbf{0}  & I_{d}       & \mathbf{0}\\
%			\hline
%			\mathbf{0}  & \mathbf{0}& I_{d}\\
%			\mathbf{0}  & I_{d}       & \mathbf{0}\\
%		\end{array}
%		\right].
%	\end{align*}
\end{frame}
\end{document}

